"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[23747],{92790:function(e,n,t){t.d(n,{K:function(){return s},Z:function(){return r}});var i=t(38398),r=function(){var e="/email/ss_premier_sub_account_activation_email";return{url:e,formattedUrl:(0,i.format)({pathname:e})}},s=function(){var e="/email/premier_cart_confirmation";return{url:e,formattedUrl:(0,i.format)({pathname:e})}}},91644:function(e,n,t){t.d(n,{KK:function(){return _},Jj:function(){return Z},GA:function(){return p},tU:function(){return v},Hg:function(){return f},c:function(){return T},P1:function(){return S},Tw:function(){return I},$6:function(){return h}});var i=t(70865),r=t(96670),s=t(87394),a=t(50930),o=t(39232),c=t(3081),u=["contributor_inactive","contributor_opted_out","MEDIA_NOT_AVAILABLE"],l=t(18505),d=t(26710),m=t(44297),f=function(e){var n=e.licenseName,t=e.cartData,i=e.asset;return n?!!(null==t?void 0:t.items.find(function(e){return e.id===(null==i?void 0:i.id)&&e.licenseId===n})):!!(null==t?void 0:t.items.find(function(e){return e.id===(null==i?void 0:i.id)}))},v=function(e){var n=e.asset;return!e.unavailableAssets.find(function(e){return e.contentId===(0,m.OP)({asset:n})&&e.contentType===n.type})},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.errors;return(void 0===n?[]:n).some(function(e){return u.includes(e)})},_=function(e){var n=e.cachedCart,t=e.newItems,s=(0,a.Z)((null==n?void 0:n.items)||[]).concat((0,a.Z)(t));return(0,r.Z)((0,i.Z)({},n),{items:s,count:s.length})},g=function(e){var n=e.item,t=e.licensedAssets;return(null==t?void 0:t.find(function(e){return e.contentId===String(n.id)}))?0:n.isUnlimited?.1:parseFloat(n.price)},y=function(e){var n=e.item1,t=e.item2,i=e.sortOrder,r=e.licensedAssets,s=g({item:void 0===n?{}:n,licensedAssets:r}),a=g({item:void 0===t?{}:t,licensedAssets:r});return i===l.sl?s-a:a-s},b=function(e){var n=e.item1,t=e.item2,i=e.sortField,r=void 0===i?"addedTime":i;return e.sortOrder===l.sl?Number(new Date(t[r]))-Number(new Date(n[r])):Number(new Date(n[r]))-Number(new Date(t[r]))},h=function(e){var n=e.primaryCart,t=e.sortField,i=e.sortOrder,r=e.alreadyLicensedPrimaryAssets;return n.sort(function(e,n){return t===c.TK.ADDED_TIME?b({item1:e,item2:n,sortField:t,sortOrder:i}):y({item1:e,item2:n,sortField:t,sortOrder:i,licensedAssets:r})})},I=function(e){var n,t=e.rolodexAddress,i=(0,s.Z)((null===(n=t.streetLines)||void 0===n?void 0:n.split("\n"))||[],2),r=i[0],a=i[1],o=t.locality,c=t.postalCode,u=t.region;return{country:t.country,company:t.company,city:o,zip:c,state:u,address1:r,address2:a}},Z=function(e){var n,t=e.billingEntity;return(null==t?void 0:null===(n=t.rolodexAddresses)||void 0===n?void 0:n.find(function(e){var n;return"licensing"===e.addressType||(null===(n=e.usages)||void 0===n?void 0:n.includes("licensing"))}))||{}},A=function(e){var n=e.asset,t=e.alreadyLicensedAssets;return(null==n?void 0:n.price)===o.q9||(0,d.te)({alreadyLicensedAssets:t,asset:n})},C=function(e){var n=e.acc,t=e.asset;return A({asset:t,alreadyLicensedAssets:e.alreadyLicensedAssets})?n:n+parseFloat(null==t?void 0:t.price)},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;return n?e.filter(function(e){return!e.isUnavailableAsset}).reduce(function(e,t){return C({acc:e,asset:t,alreadyLicensedAssets:n})},0):0},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;return e.every(function(e){return e.price===o.q9})?o.q9:T(e,n)}},26710:function(e,n,t){t.d(n,{Ax:function(){return g},H8:function(){return m},Hl:function(){return y},NV:function(){return d},Tp:function(){return b},aW:function(){return h},iI:function(){return p},j2:function(){return _},te:function(){return f},uP:function(){return l}});var i=t(70865),r=t(96670),s=t(50930),a=t(19522),o=t(39232),c=t(94054),u=t(61765),l=function(e){var n,t,i=e.license,r=e.existingAssetsLicenses;if(!r)return!((null==i?void 0:i.licenseName)&&c.b53.includes(null==i?void 0:i.licenseName))&&r;var s=(0,u.Fy)({asset:i.mediaItem});return!!(null==r?void 0:null===(t=r[null===(n=i.mediaItem)||void 0===n?void 0:n.id])||void 0===t?void 0:t.some(function(e){return e!==c._rW[s]}))},d=function(e){var n=e.subscriptions;return(void 0===n?[]:n).some(function(e){var n=e.redeemableFor;return c.SkX.some(function(e){return e===n})})?c.s5m:c.Hv9},m=function(e){return e.reduce(function(e,n){var t=n.licenseId;return e.includes(t)||e.push(t),e},[])},f=function(e){var n=e.alreadyLicensedAssets,t=e.asset;return!!n.find(function(e){var n=e.contentId,i=e.contentType,r=e.licenseId,s=t.type===o.k4?o.pV:t.type;return n===t.id&&i===s&&r===t.licenseId})},v=function(e){var n=e.licenseType,t=e.existingLicenses,i=e.asset,r=e.isSelect,a=["footage_".concat(n,"_sd"),"footage_".concat(n,"_hd")],o=(0,s.Z)(a).concat(["footage_".concat(n,"_lowres")]);return(void 0!==r&&r&&a.push("footage_".concat(n,"_4k")),i.licenseId==="footage_".concat(n,"_sd"))?null==t?void 0:t.some(function(e){return!!a.includes(e)}):i.licenseId==="footage_".concat(n,"_lowres")&&(null==t?void 0:t.some(function(e){return!!o.includes(e)}))},p=function(e){var n,t=e.existingLicenses,i=e.asset;switch(i.type){case o.FM:case o.pX:if(c.oPg.some(function(e){return v({asset:i,licenseType:e,existingLicenses:t})}))return!0;return!!(null==t?void 0:t.includes(i.licenseId));case o.k4:default:return!!(null==t?void 0:t.includes(null===(n=i.licenseId)||void 0===n?void 0:n.replace(/_unlimited/,"")))}},_=function(e){var n=e.error,t=e.t,i=(void 0===n?{}:n).meta,r=void 0===i?{}:i;if((null==r?void 0:r.exception_type)===c.JW1){var s=r.errors.slice(-1).pop().value,a="comp_limit"===s.name;return t("P1M"===s.period_length?a?"ent:monthly_comp_limit_reached":"ent:monthly_licensing_limit_reached":a?"ent:daily_comp_limit_reached":"ent:daily_licensing_limit_reached")}return t("ent:license_now_error_message")},g=function(e){var n=e.organizationId;return"organization-".concat(n)},y=function(e){var n=e.user,t=e.isItemLoaded,i=e.labels;return""!==n?n:t?i.notAwailable:""},b=function(e){var n=e.isEligibilityLoading,t=e.existingCurrentAssetLiceses;return n?void 0:t||[]},h=function(e){var n=e.asset,t=e.selectedLicenseId,s=e.activeFormatType;return(0,i.Z)((0,r.Z)((0,i.Z)({},n),{itemType:n.itemType||(0,u.rw)({asset:n}),licenseId:t}),s===a._3&&{licenseAsJpeg:!0})}},23747:function(e,n,t){t.d(n,{Zo:function(){return el}});var i,r=t(98788),s=t(47842),a=t(70865),o=t(96670),c=t(87394),u=t(50930),l=t(5163),d=t(81740),m=t(44699),f=t(39232),v=t(85330),p=t(94054),_=t(24861),g=t(29510),y=t(61765),b=t(83451),h=t(26710),I=t(18411),Z=t(80104),A=t(68781),C=t(48597),T=t(65448),S=t(9823),L=t(44297),w=t(35896),E=t(2784),N=function(e){var n,t=e.assets,i=(0,L.Tp)(t[0]);return{include:"subscriptions",content_type:(0,y.JD)({assetType:i,assetId:null===(n=t[0])||void 0===n?void 0:n.id}),content_ids:t.reduce(function(e,n){return(0,u.Z)(e).concat([n.id.toString()])},[]).join(",")}},O=function(e){var n=e.assets,t={};return n.forEach(function(e){var n=(0,L.Tp)(e),i=(0,y.JD)({assetId:e.id,assetType:n});t[i]=(0,u.Z)(t[i]?t[i]:[]).concat([e])}),t},P=function(e){var n=e.assetEligibility,t=n.permittedLicenses,i=n.subscriptions;return null==i?void 0:i.filter(function(e){var n=e.license;return t.includes(n.replace("_unlimited",""))})},M=function(e){var n,t=e.assets,i=e.user;return null===(n=Object.values(O({assets:void 0===t?[]:t})))||void 0===n?void 0:n.map(function(e){var n=N({assets:e}),t=(0,d.Td)({urlParams:{licenseeIdentifier:"organization-".concat(null==i?void 0:i.organizationId)},queryParams:n}).formattedUrl;return w.uS.get(t)})},k=function(e){var n=e.data,t=[];return n.map(function(e){var n=e.id.split("-"),i=n[n.length-1],r=P({assetEligibility:e});return t.push({assetId:i,subscriptions:r})}),t},D=t(776),j=t(9009),x=t(32819),z=t(3661),F=t(29292),U=t(68533),q=function(){var e=(0,D.yh)().analytics,n=(0,(0,U.Y)().getSearchContext)();return(0,E.useCallback)(function(t){var i=t.assets;e.productLicensed({products:(void 0===i?[]:i).map(function(e){return(0,F.bR)({asset:e,shouldGetSearchContextFromAsset:!0})}),search_context:n})},[e,n])},R=t(22921),V=t(43110),B=t(20865),H=t(92790),$=t(91644),J=t(35776),K=t(21985),Y=t(59877),G=t(96812),W=t.n(G),X=t(55112),Q=t(82603),ee=t(92067),en=RegExp(W()),et=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.emailCartCheckoutConfirmation,t=e.orderEmail;return n&&t?t.split(",").filter(function(e){return en.test(e)}):[]},ei=function(e){var n=e.purchaseOrder;return"".concat(null==n?void 0:n[0]," : ").concat(null==n?void 0:n[1]).split(" ").map(function(e){return(0,K.k)(e)}).join(" ")},er=function(e){var n=e.t,t=e.keys,i=t.currentYear,r=t.emailAddress,s=t.purchaseOrder;return{copyright:n("site-footer:copyright",{CURRENT_YEAR:i}),emailSentTo:n("ent:email_sent_to",{EMAIL_ADDRESS:r}),emailSubjectLine:"".concat(n("ent:order_confirmation_email_subject")," | ").concat(ei({purchaseOrder:s})),name:n("account:profile_name"),needAssistance:n("ent:contact_sales_representative"),orderConfirmation:n("ent:order_confirmation"),purchaseInformation:n("ent:purchase_information_key"),shutterstockAddress:n("tos:tos_2020_09_04_part_v_24_table_r2_c2_l2"),shutterstockInc:n("tos:tos_2020_09_04_part_v_24_table_r2_c2_l1"),subtotal:n("ent:order_confirmation_email_subtotal"),thisIsNotAnInvoice:n("ent:not_an_invoice")}},es=function(){var e=(0,Y.$G)(J.jp5).t,n=(0,V.j)().data,t=(0,Q.b)().data,i=(0,X.B)().data,r=(0,ee.z)({fetchTrigger:!0})||{},s=r.name,a=r.email,o=r.phone,c=(0,g.PE)(),l=c.locale,d=c.fullLocale,m=(0,R.o)();return{sendOrderConfirmationEmails:(0,E.useCallback)(function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=r.cartTotalCurrency,f=r.filteredOrderMetadata,v=r.licenseMetadata,p=r.priceType,_=(0,u.Z)((null==t?void 0:t.emailCartCheckoutConfirmation)?[null==n?void 0:n.email]:[]).concat((0,u.Z)(et(i)));if(_.length&&(null==f?void 0:f.length)){var g,y,b,h,I=er({t:e,keys:{currentYear:new Date().getFullYear(),emailAddress:null==n?void 0:n.email,purchaseOrder:Object.entries(v)[0],repName:s,repPhoneNumber:o,repEmail:a}});try{var Z={cartItems:f,fullName:null==n?void 0:n.fullName,invoiceDate:new Intl.DateTimeFormat(d).format(new Date),labels:I,licenseMetadata:v,repEmail:a,repName:s,repPhoneNumber:o,totalAmount:m({price:(0,$.P1)(f,[]),localeCurrencyOverride:c,priceType:p}),username:null==n?void 0:n.username};w.IZ.post((0,H.K)().formattedUrl,{emails:(0,u.Z)(new Set(_)),emailBody:Z,emailSubject:"".concat(I.emailSubjectLine),language:l})}catch(e){null===(g=window.NREUM)||void 0===g||null===(y=g.setTransactionName)||void 0===y||y.call(g,"sendOrderConfirmationEmail/".concat("noticeError")),null===(b=window.NREUM)||void 0===b||null===(h=b.noticeError)||void 0===h||h.call(b,e,{message:"Failed sending order confirmation emails to: ".concat(_.join(", "))})}}},[d,l,i,m,a,s,o,e,null==n?void 0:n.email,null==n?void 0:n.fullName,null==n?void 0:n.username,null==t?void 0:t.emailCartCheckoutConfirmation])}},ea=t(43012),eo=(i={},(0,s.Z)(i,p.dWU,d.CE),(0,s.Z)(i,p.zM6,d.s0),i),ec=function(e){var n,t,i=e.asset,r=e.subscriptions,s=(0,y.qw)({asset:i}),a=i.licenseId,o=i.contentTier;switch(s){case f.pX:return(0,A.I)({assetType:f.pX,subscriptions:(0,u.Z)(null!==(n=null==r?void 0:r.videoSubscriptions)&&void 0!==n?n:[]).concat((0,u.Z)(null!==(t=null==r?void 0:r.videoCompSubscriptions)&&void 0!==t?t:[])),selectedLicenseId:a});case f.xF:case f.j0:return(0,C.$)({subscriptions:(0,u.Z)(r.musicSubscriptions).concat((0,u.Z)(r.musicCompSubscriptions)),licenseName:i.licenseId});case f.tn:return(0,C.$)({subscriptions:(0,u.Z)(r.sfxSubscriptions).concat((0,u.Z)(r.sfxCompSubscriptions)),licenseName:i.licenseId});case f.gP:return(0,C.$)({subscriptions:(0,u.Z)(r.editorialImageSubscriptions).concat((0,u.Z)(r.editorialImageCompSubscriptions),(0,u.Z)(r.editorialVideoSubscriptions),(0,u.Z)(r.editorialVideoCompSubscriptions)),licenseName:i.licenseId,contentTier:o});case f.k4:default:return(0,C.$)({subscriptions:(0,u.Z)(r.imageSubscriptions).concat((0,u.Z)(r.imageCompSubscriptions)),licenseName:i.licenseId,contentTier:o})}},eu=function(e){var n=ec({asset:e.asset,subscriptions:e.subscriptions});return(0,T.q)({subscription:n})?(0,o.Z)((0,a.Z)({},n),{creditPrice:f.q9,creditType:_.Zm}):n},el=function(){var e,n=(0,S.D)().isBrandEnterprise,t=(0,B.av)().data,i=(0,c.Z)((0,E.useState)(!1),2),s=i[0],u=i[1],d=(0,c.Z)((0,E.useState)(""),2),_=d[0],C=d[1],T=(0,c.Z)((0,E.useState)({}),2),L=T[0],N=T[1],O=(0,V.j)().data,P=(0,c.Z)((0,x.VM)(function(e){return e}),2)[1],F=(0,D.uA)()||(0,z.H7)(),U=q(),H=(0,R.o)(),$=(0,ea.GB)(),J=(0,g.PE)().locale,K=es().sendOrderConfirmationEmails;return{isLicensing:s,licensingAssetsHandler:(0,E.useCallback)((e=(0,r.Z)(function(e){var i,s,c,d,_,g,T,S,L,E,D,x,z,q,R,V,B,Y,G,W,X,Q,ee,en,et,ei,er,es;return(0,l.__generator)(this,function(ea){switch(ea.label){case 0:var ec;s=void 0===(i=e.alreadyLicensedAssets)?[]:i,d=void 0===(c=e.assets)?[]:c,g=void 0===(_=e.cartMetadata)?{}:_,S=void 0===(T=e.format)?"":T,E=void 0===(L=e.licenseeMetadata)?{}:L,x=void 0!==(D=e.isVideoComp)&&D,q=void 0===(z=e.licenseMetadata)?{}:z,R=e.licensingType,B=void 0===(V=e.selectedAssetSize)?"":V,ec=(0,r.Z)(function(){var e;return(0,l.__generator)(this,function(i){switch(i.label){case 0:return[4,Promise.all(M({assets:d,user:O}))];case 1:var s;return e=k({data:i.sent().map(function(e){var n=e.data;return(0,j.O)(n)}).flat()}),[4,Promise.all(d.map((s=(0,r.Z)(function(n){var t,i,r,s,c,u,d;return(0,l.__generator)(this,function(l){switch(l.label){case 0:return t=(0,y.qw)({asset:n}),i=n.licenseId,r=((null==e?void 0:e.find(function(e){return e.assetId===String(n.id)}))||{}).subscriptions,c=(s=(0,A.I)({assetType:t,subscriptions:r,selectedLicenseId:i})||{}).id,u=s.license,[4,(0,b.Oo)({asset:n,format:S,selectedAssetSize:B,licenseName:u,isVideoComp:x})];case 1:return d=l.sent(),[2,(0,o.Z)((0,a.Z)({},d,B&&I.Bg[B]&&{comp_size:B},t===f.tn&&{override_filename:"".concat(v.Oq,"_").concat(n.id,".").concat(S||d.content_format)}),{license_name:u,show_modal:!0,subscription_id:c})]}})}),function(e){return s.apply(this,arguments)})))];case 2:return[2,{licensingPayload:{content:i.sent(),license_metadata:q,required_cookies:"",decode_hadron_ids:n},orderMetadata:d.map(function(e){var n=e.currency,i=e.description,r=e.descriptionLanguageMap,s=e.id,a=e.itemType,o=e.headline,c=e.licenseId,u=e.preview,l=e.price,d=e.priceType,m=e.src,f=e.thumb,v=e.thumbImageUrl,p=e.title,_=e.type,g=n,y=l,b=d;if(!g||!y||!b){var h=eu({asset:e,subscriptions:t}),I=h.creditCurrency,Z=h.creditPrice,A=h.creditType;g=g||I,y=y||Z,b=d||A}return g&&!Y&&(Y=g),b&&!G&&(G=b),{description:(void 0===r?{}:r)[J]||i,formattedPrice:H({price:y,localeCurrencyOverride:g,priceType:b}),headline:o,id:s,itemType:a,licenseId:c,licenseName:$({licenseName:c}),price:y,priceType:b,thumbnailSrc:m||v||(void 0===u?{}:u).url||f,title:p,type:_}})}]}})}),W=function(){return ec.apply(this,arguments)},ea.label=1;case 1:return ea.trys.push([1,4,5,6]),u(!0),C(""),[4,W({assets:d.map(function(e){return e.mediaItem?(0,o.Z)((0,a.Z)({},e.mediaItem),{licenseId:e.licenseId}):e}),isVideoComp:x,licenseMetadata:q,selectedAssetSize:B,subscriptions:t})];case 2:return en=(ee=ea.sent()).licensingPayload,et=ee.orderMetadata,ei=eo[R]({urlParams:{licenseeIdentifier:"organization-".concat(null==O?void 0:O.organizationId)}}).formattedUrl,[4,w.uS.post(ei,en,(0,Z.S)({trackingId:F}))];case 3:return er=ea.sent(),U({assets:d}),P({assets:d,cartMetadata:g,licensedContent:(null===(X=(0,j.O)(er.data))||void 0===X?void 0:null===(Q=X.meta)||void 0===Q?void 0:Q.licensedContent)||[]}),d.some(function(e){var n=e.licenseId;return p.b53.includes(n)})||K({cartTotalCurrency:Y,filteredOrderMetadata:et.filter(function(e){return!(0,h.te)({alreadyLicensedAssets:s,asset:e})}),licenseMetadata:E,priceType:G}),C(m.MR),[2,er];case 4:throw N(es=ea.sent()),C(m.cM),es;case 5:return u(!1),[7];case 6:return[2]}})}),function(n){return e.apply(this,arguments)}),[O,n,J,H,$,t,F,U,P,K]),licensingError:L,licensingStatus:_,setIsLicensing:u,setLicensingStatus:C}}},55112:function(e,n,t){t.d(n,{B:function(){return m}});var i=t(70865),r=t(81740),s=t(94054),a=t(55988),o=t(52884),c=t(35896),u=t(9009),l=t(85482),d=t(43110),m=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).queryParams,n=(0,d.j)().data,t=(0,i.Z)({target:s.dlz,site_name:a.mC,setting_type:s.dlz},e);return(0,l.ZP)((null==n?void 0:n.id)&&(null==n?void 0:n.organizationId)&&(0,r.nI)({queryParams:t}).formattedUrl,function(e){return c.uS.get(e).then(function(e){return(0,u.O)(e.data)})},{dedupingInterval:o.yR})}}}]);
//# sourceMappingURL=23747-77b8e63386d2c610.js.map